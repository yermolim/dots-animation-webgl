!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).dotsAnim={})}(this,(function(t){"use strict";class e{constructor(t=0,e=0){this.length=2,this.x=t,this.y=e}static multiplyByScalar(t,i){return new e(t.x*i,t.y*i)}static addScalar(t,i){return new e(t.x+i,t.y+i)}static normalize(t){return(new e).setFromVec2(t).normalize()}static add(t,i){return new e(t.x+i.x,t.y+i.y)}static substract(t,i){return new e(t.x-i.x,t.y-i.y)}static dotProduct(t,e){return t.x*e.x+t.y*e.y}static applyMat3(t,e){return t.clone().applyMat3(e)}static lerp(t,e,i){return t.clone().lerp(e,i)}static rotate(t,e,i){return t.clone().rotate(e,i)}static equals(t,e,i=6){return t.equals(e)}static getDistance(t,e){const i=e.x-t.x,s=e.y-t.y;return Math.sqrt(i*i+s*s)}clone(){return new e(this.x,this.y)}set(t,e){return this.x=t,this.y=e,this}setFromVec2(t){return this.x=t.x,this.y=t.y,this}multiplyByScalar(t){return this.x*=t,this.y*=t,this}addScalar(t){return this.x+=t,this.y+=t,this}getMagnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const t=this.getMagnitude();return t&&(this.x/=t,this.y/=t),this}add(t){return this.x+=t.x,this.y+=t.y,this}substract(t){return this.x-=t.x,this.y-=t.y,this}dotProduct(t){return e.dotProduct(this,t)}applyMat3(t){if(9!==t.length)throw new Error("Matrix must contain 9 elements");const{x:e,y:i}=this,[s,n,,o,r,,a,h]=t;return this.x=e*s+i*o+a,this.y=e*n+i*r+h,this}lerp(t,e){return this.x+=e*(t.x-this.x),this.y+=e*(t.y-this.y),this}rotate(t,e){const i=Math.sin(e),s=Math.cos(e),n=this.x-t.x,o=this.y-t.y;return this.x=n*s-o*i+t.x,this.y=n*i+o*s+t.y,this}equals(t,e=6){return+this.x.toFixed(e)==+t.x.toFixed(e)&&+this.y.toFixed(e)==+t.y.toFixed(e)}toArray(){return[this.x,this.y]}*[Symbol.iterator](){yield this.x,yield this.y}}class i{constructor(t=null){this.expectedFps=60,this.number=null,this.density=5e-5,this.dprDependentDensity=!0,this.dprDependentDimensions=!0,this.minR=1,this.maxR=6,this.minSpeedX=-.5,this.maxSpeedX=.5,this.minSpeedY=-.5,this.maxSpeedY=.5,this.blur=1,this.fill=!0,this.colorsFill=["#ffffff","#fff4c1","#faefdb"],this.opacityFill=null,this.opacityFillMin=0,this.opacityFillStep=0,this.stroke=!1,this.colorsStroke=["#ffffff"],this.opacityStroke=1,this.opacityStrokeMin=0,this.opacityStrokeStep=0,this.drawLines=!0,this.lineColor="#717892",this.lineLength=150,this.lineWidth=2,this.actionOnClick=!0,this.actionOnHover=!0,this.onClickCreate=!1,this.onClickMove=!0,this.onHoverMove=!0,this.onHoverDrawLines=!0,this.onClickCreateNDots=10,this.onClickMoveRadius=200,this.onHoverMoveRadius=50,this.onHoverLineRadius=150,t&&Object.assign(this,t)}}class s{constructor(t,i,s){this._resolution=new e,this._pointerPosition=new e,this._animationStartTimeStamp=0,this._lastFrameTimeStamp=0,this._lastFrameTime=0,this._lastFramePreparationTime=0,this._lastFrameRenderTime=0,this.onResize=t=>{const e=window.devicePixelRatio,i=this._container.getBoundingClientRect(),s=i.width*e,n=i.height*e;this._canvas.width=s,this._canvas.height=n,this._resolution.set(s,n)},this.onPointerMove=t=>{const e=window.devicePixelRatio,i=this._container.getBoundingClientRect(),s=i.left+document.documentElement.scrollLeft,n=i.top+document.documentElement.scrollTop,o=(t.clientX-s+window.pageXOffset)*e,r=(t.clientY-n+window.pageYOffset)*e;this._pointerPosition.set(o,r)},this.onPointerDown=t=>{this._pointerIsDown=!0},this.onPointerUp=t=>{this._pointerIsDown=!1},this._options=i,this._container=t,this._controlType=s,this.initCanvas(),this.initControl(),this.addEventListeners()}destroy(){this.stop(),this.removeEventListeners(),this._control.destroy(),this._canvas.remove()}start(){if(this._animationStartTimeStamp){const t=performance.now()-this._lastFrameTimeStamp;this._animationStartTimeStamp+=t}this._animationTimerId=setInterval((()=>{const t=performance.now(),e=t-this._animationStartTimeStamp;this._control.prepareNextFrame(this._resolution,this._pointerPosition,this._pointerIsDown,e),this._lastFramePreparationTime=performance.now()-t,requestAnimationFrame((()=>{const e=performance.now();this._control.renderFrame();const i=performance.now();this._lastFrameTimeStamp=i,this._lastFrameRenderTime=i-e,this._lastFrameTime=i-t}))}),1e3/this._options.expectedFps)}pause(){this._animationTimerId&&(clearInterval(this._animationTimerId),this._animationTimerId=null)}stop(){this.pause(),this._animationStartTimeStamp=0,window.setTimeout((()=>this._control.clear()),20)}initCanvas(){const t=document.createElement("canvas");t.id=crypto.getRandomValues(new Uint32Array(4)).join("-"),t.style.display="block",t.style.width="100%",t.style.height="100%",t.style.filter=`blur(${this._options.blur}px)`,this._container.append(t),this._canvas=t,this.onResize(null)}initControl(){this._control=new this._controlType(this._canvas.getContext("webgl"),this._options)}addEventListeners(){this._resizeObserver=new ResizeObserver(this.onResize),this._resizeObserver.observe(this._container),this._container.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerdown",this.onPointerDown),window.addEventListener("pointerup",this.onPointerUp)}removeEventListeners(){this._resizeObserver.unobserve(this._container),this._resizeObserver.disconnect(),this._resizeObserver=null,this._container.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerdown",this.onPointerDown),window.removeEventListener("pointerup",this.onPointerUp)}}class n{constructor(t,e){this._vertexShader="\n    #pragma vscode_glsllint_stage : vert\n\n    attribute vec4 position;\n\n    void main() {\n      gl_Position = position;\n    }\n  ",this._fragmentShader="\n    #pragma vscode_glsllint_stage : frag\n\n    precision highp float;\n\n    void main() {\n      gl_FragColor = vec4(1, 0, 0, 1);\n    }\n  ",this._options=e,this._gl=t}prepareNextFrame(t,e,i,s){this.resize(t)}renderFrame(){}clear(){this._gl.clearColor(0,0,0,0),this._gl.clear(this._gl.COLOR_BUFFER_BIT)}destroy(){}resize(t){this._gl.canvas.width!==t.x&&(this._gl.canvas.width=t.x),this._gl.canvas.height!==t.y&&(this._gl.canvas.height=t.y)}}t.AnimationFactory=class{static createDotsAnimation(t,e=null){const o=document.querySelector(t);if(!o)throw new Error("Container not found");if("static"===window.getComputedStyle(o).getPropertyValue("position"))throw new Error("Container is not positioned");const r=new i(e);return new s(o,r,n)}},Object.defineProperty(t,"__esModule",{value:!0})}));
