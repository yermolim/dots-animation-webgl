class t{constructor(t=0,i=0){this.length=2,this.x=t,this.y=i}static multiplyByScalar(i,e){return new t(i.x*e,i.y*e)}static addScalar(i,e){return new t(i.x+e,i.y+e)}static normalize(i){return(new t).setFromVec2(i).normalize()}static add(i,e){return new t(i.x+e.x,i.y+e.y)}static substract(i,e){return new t(i.x-e.x,i.y-e.y)}static dotProduct(t,i){return t.x*i.x+t.y*i.y}static applyMat3(t,i){return t.clone().applyMat3(i)}static lerp(t,i,e){return t.clone().lerp(i,e)}static rotate(t,i,e){return t.clone().rotate(i,e)}static equals(t,i,e=6){return t.equals(i)}static getDistance(t,i){const e=i.x-t.x,s=i.y-t.y;return Math.sqrt(e*e+s*s)}clone(){return new t(this.x,this.y)}set(t,i){return this.x=t,this.y=i,this}setFromVec2(t){return this.x=t.x,this.y=t.y,this}multiplyByScalar(t){return this.x*=t,this.y*=t,this}addScalar(t){return this.x+=t,this.y+=t,this}getMagnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const t=this.getMagnitude();return t&&(this.x/=t,this.y/=t),this}add(t){return this.x+=t.x,this.y+=t.y,this}substract(t){return this.x-=t.x,this.y-=t.y,this}dotProduct(i){return t.dotProduct(this,i)}applyMat3(t){if(9!==t.length)throw new Error("Matrix must contain 9 elements");const{x:i,y:e}=this,[s,n,,r,o,,a,h]=t;return this.x=i*s+e*r+a,this.y=i*n+e*o+h,this}lerp(t,i){return this.x+=i*(t.x-this.x),this.y+=i*(t.y-this.y),this}rotate(t,i){const e=Math.sin(i),s=Math.cos(i),n=this.x-t.x,r=this.y-t.y;return this.x=n*s-r*e+t.x,this.y=n*e+r*s+t.y,this}equals(t,i=6){return+this.x.toFixed(i)==+t.x.toFixed(i)&&+this.y.toFixed(i)==+t.y.toFixed(i)}toArray(){return[this.x,this.y]}*[Symbol.iterator](){yield this.x,yield this.y}}class i{constructor(t=null){this.expectedFps=60,this.number=null,this.density=5e-5,this.dprDependentDensity=!0,this.dprDependentDimensions=!0,this.minR=1,this.maxR=6,this.minSpeedX=-.5,this.maxSpeedX=.5,this.minSpeedY=-.5,this.maxSpeedY=.5,this.blur=1,this.fill=!0,this.colorsFill=["#ffffff","#fff4c1","#faefdb"],this.opacityFill=null,this.opacityFillMin=0,this.opacityFillStep=0,this.stroke=!1,this.colorsStroke=["#ffffff"],this.opacityStroke=1,this.opacityStrokeMin=0,this.opacityStrokeStep=0,this.drawLines=!0,this.lineColor="#717892",this.lineLength=150,this.lineWidth=2,this.actionOnClick=!0,this.actionOnHover=!0,this.onClickCreate=!1,this.onClickMove=!0,this.onHoverMove=!0,this.onHoverDrawLines=!0,this.onClickCreateNDots=10,this.onClickMoveRadius=200,this.onHoverMoveRadius=50,this.onHoverLineRadius=150,t&&Object.assign(this,t)}}class e{constructor(i,e,s){this._resolution=new t,this._pointerPosition=new t,this._animationStartTimeStamp=0,this._lastFrameTimeStamp=0,this._lastFrameTime=0,this._lastFramePreparationTime=0,this._lastFrameRenderTime=0,this.onResize=t=>{const i=window.devicePixelRatio,e=this._container.getBoundingClientRect(),s=e.width*i,n=e.height*i;this._canvas.width=s,this._canvas.height=n,this._resolution.set(s,n)},this.onPointerMove=t=>{const i=window.devicePixelRatio,e=this._container.getBoundingClientRect(),s=e.left+document.documentElement.scrollLeft,n=e.top+document.documentElement.scrollTop,r=(t.clientX-s+window.pageXOffset)*i,o=(t.clientY-n+window.pageYOffset)*i;this._pointerPosition.set(r,o)},this.onPointerDown=t=>{this._pointerIsDown=!0},this.onPointerUp=t=>{this._pointerIsDown=!1},this._options=e,this._container=i,this._controlType=s,this.initCanvas(),this.initControl(),this.addEventListeners()}destroy(){this.stop(),this.removeEventListeners(),this._control.destroy(),this._canvas.remove()}start(){if(this._animationStartTimeStamp){const t=performance.now()-this._lastFrameTimeStamp;this._animationStartTimeStamp+=t}this._animationTimerId=setInterval((()=>{const t=performance.now(),i=t-this._animationStartTimeStamp;this._control.prepareNextFrame(this._resolution,this._pointerPosition,this._pointerIsDown,i),this._lastFramePreparationTime=performance.now()-t,requestAnimationFrame((()=>{const i=performance.now();this._control.renderFrame();const e=performance.now();this._lastFrameTimeStamp=e,this._lastFrameRenderTime=e-i,this._lastFrameTime=e-t}))}),1e3/this._options.expectedFps)}pause(){this._animationTimerId&&(clearInterval(this._animationTimerId),this._animationTimerId=null)}stop(){this.pause(),this._animationStartTimeStamp=0,window.setTimeout((()=>this._control.clear()),20)}initCanvas(){const t=document.createElement("canvas");t.id=crypto.getRandomValues(new Uint32Array(4)).join("-"),t.style.display="block",t.style.width="100%",t.style.height="100%",t.style.filter=`blur(${this._options.blur}px)`,this._container.append(t),this._canvas=t,this.onResize(null)}initControl(){this._control=new this._controlType(this._canvas.getContext("webgl"),this._options)}addEventListeners(){this._resizeObserver=new ResizeObserver(this.onResize),this._resizeObserver.observe(this._container),this._container.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerdown",this.onPointerDown),window.addEventListener("pointerup",this.onPointerUp)}removeEventListeners(){this._resizeObserver.unobserve(this._container),this._resizeObserver.disconnect(),this._resizeObserver=null,this._container.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerdown",this.onPointerDown),window.removeEventListener("pointerup",this.onPointerUp)}}class s{constructor(t,i){this._vertexShader="\n    #pragma vscode_glsllint_stage : vert\n\n    attribute vec4 position;\n\n    void main() {\n      gl_Position = position;\n    }\n  ",this._fragmentShader="\n    #pragma vscode_glsllint_stage : frag\n\n    precision highp float;\n\n    void main() {\n      gl_FragColor = vec4(1, 0, 0, 1);\n    }\n  ",this._options=i,this._gl=t}prepareNextFrame(t,i,e,s){this.resize(t)}renderFrame(){}clear(){this._gl.clearColor(0,0,0,0),this._gl.clear(this._gl.COLOR_BUFFER_BIT)}destroy(){}resize(t){this._gl.canvas.width!==t.x&&(this._gl.canvas.width=t.x),this._gl.canvas.height!==t.y&&(this._gl.canvas.height=t.y)}}class n{static createDotsAnimation(t,n=null){const r=document.querySelector(t);if(!r)throw new Error("Container not found");if("static"===window.getComputedStyle(r).getPropertyValue("position"))throw new Error("Container is not positioned");const o=new i(n);return new e(r,o,s)}}export{n as AnimationFactory};
